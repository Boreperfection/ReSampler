/*
* Copyright (C) 2016 - 2017 Judd Niemann - All Rights Reserved
* You may use, distribute and modify this code under the
* terms of the GNU Lesser General Public License, version 2.1
*
* You should have received a copy of GNU Lesser General Public License v2.1
* with this file. If not, please refer to: https://github.com/jniemann66/ReSampler
*/

#ifndef NOISESHAPE_H
#define NOISESHAPE_H 1

// noiseshape.h : contains filter coefficients for noise shaping

//////////////////////////
//
// Filter Coefficients
//
//////////////////////////

const double noiseShaperPassThrough[1] = {
	1
};

// filters based on E-weighted curves
// from 'Minimally Audible Noise Shaping' (*)

const double modew44[] = { // Modified E-weighted (appendix: 2)
	1.6620, -1.2630, 0.4827,
	-0.2913, 0.1268,-0.1124,
	0.03252, -0.01265, -0.03524
};

const double lips44[] = { // improved E-weighted (appendix: 5)
	2.033, -2.165, 1.959,
	-1.590, 0.6149
};

const double impew44[] = { // improved E-weighted 9 coeff (appendix: 6)
	2.847, -4.685,  6.214,
	-7.184, 6.639, -5.032,
	3.263, -1.632, 0.4191
};

// filters based on F-weighted curves
// from 'Psychoacoustically Optimal Noise Shaping' (**)
// this filter is the "F-Weighted" noise filter described by Wannamaker
// It is designed to produce minimum audibility:

const double wan3[] = { // Table 3; 3 Coefficients
	1.623, -0.982, 0.109
};

const double wan9[] = { // Table 3; 9 Coefficients ('f-weighted' in SoX)
	2.4120002321781  , -3.370000324394779,  3.937000378973959,
	-4.174000401787478,  3.353000322758366, -2.205000212252369,
	1.281000123308519, -0.569000054771701,  0.084700008153185
};

const double wan24[] = { // Table 4; 24 Coefficients
	2.391510032751124, -3.284444044979632,  3.679506050389904,
	-3.635044049781009,  2.524185034568077, -1.146701015703782,
	0.115354001579743,  0.51374500703561 , -0.749277010261162,
	0.512386007016999, -0.188997002588268, -0.043705000598528,
	0.149843002052063, -0.151186002070453,  0.076302001044937,
	-0.012070000165296, -0.021127000289329,  0.025232000345547,
	-0.016121000220773,  0.004453000060982,  0.000876000011999,
	-0.001799000024635,  0.0007740000106  , -0.000128000001755
};

const double highShib44[20] = { // High-Shibata 44k (20 taps)

	3.0259189605712890625, -6.0268716812133789062,   9.195003509521484375,
	-11.824929237365722656, 12.767142295837402344, -11.917946815490722656,
	9.1739168167114257812,  -5.3712320327758789062, 1.1393624544143676758,
	2.4484779834747314453,  -4.9719839096069335938,   6.0392003059387207031,
	-5.9359521865844726562,  4.903278350830078125,   -3.5527443885803222656,
	2.1909697055816650391, -1.1672389507293701172,  0.4903914332389831543,
	-0.16519790887832641602,  0.023217858746647834778

};

const double experimental1[] = {
	1.552893042564392, -1.459592938423157,  0.557879626750946,
	0.004247912205756, -0.247446924448013, -0.010727410204709,
	0.024524994194508, -0.084559261798859, -0.021680492907763,
	-0.007851422764361, -0.010477361269295, -0.006129192188382,
	-0.005679284688085, -0.00112113065552 , -0.001433005789295,
	-0.000978846335784, -0.000214568979573,  0.000104520288005,
	0.001021763193421,  0.001436339691281
};

const double experimental2[10] = {
	/*
	-0.156273992376491,
	0.288411025954531,
	-0.197304884034655,
	0.129645690377117,
	-0.070106447409447,
	-0.041085952214833,
	0.050192058358397,
	0.012898104533912,
	0.015359661780711,
	0.020719908866823,
	-0.011813660625704,
	0.007166224946099,
	-0.005038759518396,
	-0.006848775277087,
	0.004246829537086,
	0.003585617408335
	*/
	/*
	- 0.113267579111506,
	0.215432144212954,
	-0.206263340877997,
	0.246064185480709,
	-0.054824084366412,
	0.179481292975895,
	-0.002556243072638,
	0.013174521887528,
	-0.000238789304217,
	0.122047711532922,
	0.088340424932406,
	0.032665078075013
	*/
	/*
	2.443547641112401, -2.7695227909179  ,
	2.1723584724558  , -1.853027710857   ,  0.83518645478592 ,
	-0.22331085560097 ,  0.086416523201232, -0.037087490647368,
	-0.029912769413115, -0.069178326196128, -0.000737963518864
	*/
	2.1458349310385  , -2.8886247979953  ,  3.1440240984815  ,
	-2.7691389969061  ,  1.8410749156878  , -1.03787966035156 ,
	0.45566921793679 , -0.12410827054639 ,  0.013088865078523,
	-0.002197012454707

	/*
	3.528870344161987,  -7.397897720336914,  11.062552452087402,
	-12.915676116943359,  12.005429267883301,  -8.976534843444824,
	5.175451755523682,  -2.103446006774902,   0.348601877689362,
	0.211675748229027,  -0.179740116000175,   0.030822610482574,
	0.024646494537592,  -0.010657157748938,  -0.007913443259895,
	0.004375995136797,   0.004815561696887,  -0.00556468218565 ,
	0.001390703488141,   0.002223829738796,  -0.000689988140948,
	-0.000269168231171,   0.000755135435611,  -0.
	*/
};

const double std_44[10] = {
	2.1458349310385  , -2.8886247979953  ,  3.1440240984815  ,
	-2.7691389969061  ,  1.8410749156878  , -1.03787966035156 ,
	0.45566921793679 , -0.12410827054639 ,  0.013088865078523,
	-0.002197012454707
};

#endif
